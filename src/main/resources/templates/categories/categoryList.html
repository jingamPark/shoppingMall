<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layout}">
<head>
    <title>Categories</title>

</head>
<body>

<div layout:fragment="content" >

        <h1>카테고리 목록</h1>
        <table>
            <thead>
            <tr>
                <th>Id</th>
                <th>Title</th>
                <th>Description</th>

            </tr>
            </thead>
            <tbody>
            <tr th:each="category : ${categories}">
                <td th:text="${category.id}"></td>
                <td>
                    <a th:href="'/categories/'+${category.id}" th:text="${category.title}"></a>
                </td>
                <td th:text="${category.description}">Description</td>
                <td>
                    <button type="button" class="btn btn-danger" th:onclick="'deleteCategory(' + ${category.id} + ')'">삭제</button>
                </td>
            </tr>
            </tbody>
        </table>

    <script>
        function deleteCategory(categoryId) {
            if (confirm("정말로 이 카테고리를 삭제하시겠습니까?")) {
                fetch(`/categories/${categoryId}`, {
                    method: 'DELETE',
                })
                    .then(response => {
                        if (response.ok) {
                            alert("카테고리가 삭제되었습니다.");
                            location.reload();
                        } else {
                            alert("카테고리 삭제에 실패했습니다.");
                        }
                    })
                    .catch(error => {
                        console.error('Error:', error);
                    });
            }
        }
    </script>

</div> <!--content-->
</body>
</html>